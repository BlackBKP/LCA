<!-- Import Job View Index -->
<div class="container-fluid" style="padding-top:10px">

    <div class="info-box bg-dark">
        <div class="info-box-content">
            <h3 class="info-box-text">Imports</h3>
        </div>
    </div>

    <label id="file_label">Choose File</label>
    <input id="import_file" type="file"/>

    <div class="card">
        <div class="card-header">
            <span class="card-title">Upload Content</span>
        </div>
        <div class="card-body">
            <div id="divPrint"></div>
        </div>
    </div>

</div>

@section Scripts
{
    <script type="text/javascript">

        $(document).ready(function () {

        });

        $('#import_file').on('change', async function () {
            var fileExtension = ['xls', 'xlsx'];
            var filename = $('#import_file').val();

            if (filename.length == 0) {
                alert("Please Select a File");
            }
            else {
                var extension = filename.replace(/^.*\./, '');
                if ($.inArray(extension, fileExtension) == -1) {
                    alert("Please select only excel files.");
                }
            }

            var fdata = new FormData();
            var fileupload = $('#import_file').get(0);
            var files = fileupload.files;

            //console.log("File");
            //console.log(files);

            fdata.append(files[0].name, files[0]);
            $('#file_label').text(files[0].name);
            await $.ajax({
                type: "POST",
                url: "ImportJob/Import",
                beforeSend: function (xhr) {
                    xhr.setRequestHeader("XSRF-TOKEN",
                        $('input:hidden[name="__RequestVerificationToken"]').val());
                },
                data: fdata,
                contentType: false,
                processData: false,
                success: function (response) {
                    if (response.length == 0)
                        alert('Some error occured while uploading');
                    else {
                        console.log("Response");
                        $('#divPrint').html(response);
                    }
                },
                error: function (e) {
                    $('#divPrint').html(e.responseText);
                }
            });
        });

        function GenerateTable() {

        }

    </script>
}